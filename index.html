<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SmartTimer V21: Pro Content & Limits</title>
    <style>
        :root {
            /* æš—è‰²ä¸»é¡Œ (é è¨­) */
            --text-main: #ffffff;
            --text-sub: rgba(255, 255, 255, 0.6);
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-border: rgba(255, 255, 255, 0.05);
            --btn-deck: rgba(0, 0, 0, 0.3);
            
            --bg-idle: linear-gradient(135deg, #1e1e1e 0%, #3a3a3a 100%);
            --bg-prep: linear-gradient(135deg, #d35400 0%, #e67e22 100%);
            --bg-warmup: linear-gradient(135deg, #6c3483 0%, #8e44ad 100%);
            --bg-work: linear-gradient(135deg, #922b21 0%, #c0392b 100%);
            --bg-gym-work: linear-gradient(135deg, #001f3f 0%, #003366 100%);
            --bg-rest: linear-gradient(135deg, #145a32 0%, #27ae60 100%);
            --bg-finish: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);

            /* Modal */
            --modal-bg: #2c2c2e;
            --modal-text: #ffffff;
            --input-bg: #1c1c1e;
            --input-border: #444;
            --setting-row-bg: #3a3a3c;
            --lang-item-bg: #3a3a3c;
        }

        /* äº®è‰²ä¸»é¡Œ */
        body.light-theme {
            --text-main: #2c3e50;
            --text-sub: rgba(0, 0, 0, 0.6);
            --card-bg: rgba(255, 255, 255, 0.85);
            --card-border: rgba(0, 0, 0, 0.05);
            --btn-deck: rgba(255, 255, 255, 0.8);
            --bg-idle: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            
            --modal-bg: #ffffff;
            --modal-text: #333333;
            --input-bg: #f0f0f0;
            --input-border: #ccc;
            --setting-row-bg: #f8f9fa;
            --lang-item-bg: #f0f0f0;
        }

        body.light-theme.active-mode {
            --text-main: #ffffff;
            --text-sub: rgba(255, 255, 255, 0.8);
            --btn-deck: rgba(0, 0, 0, 0.2);
            --card-bg: rgba(0, 0, 0, 0.2);
        }

        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #000; color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
            overflow: hidden; -webkit-user-select: none; user-select: none;
            display: flex; justify-content: center; transition: color 0.3s;
        }

        #app-container {
            width: 100%; max-width: 480px; height: 100dvh;
            background: var(--bg-idle);
            display: flex; flex-direction: column;
            position: relative; box-shadow: 0 0 30px rgba(0,0,0,0.5);
            transition: background 0.5s ease;
        }

        .hidden { display: none !important; }
        .screen {
            flex: 1; display: flex; flex-direction: column;
            height: 100%; box-sizing: border-box; padding: 20px 20px 0 20px;
            overflow: hidden;
        }

        /* --- Header --- */
        .header { 
            flex-shrink: 0; margin-top: 20px; margin-bottom: 20px; 
            display: flex; justify-content: space-between; align-items: flex-start;
        }
        .header-text { display: flex; flex-direction: column; width: 50%; }
        .app-title { font-size: 28px; font-weight: 800; margin-bottom: 5px; line-height: 1.2;}
        .app-subtitle { font-size: 14px; color: var(--text-sub); }
        
        .header-controls { 
            display: flex; flex-direction: column; gap: 8px; align-items: flex-end; 
        }
        
        .theme-switch {
            background: var(--card-bg); border: 1px solid var(--card-border);
            border-radius: 20px; padding: 4px; display: flex; align-items: center;
            cursor: pointer; width: 120px; height: 32px; position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .switch-knob {
            width: 26px; height: 26px; background: #fff; border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2); position: absolute;
            left: 4px; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 2;
        }
        .switch-label {
            width: 100%; text-align: center; font-size: 12px; font-weight: 600;
            color: var(--text-main); z-index: 1; padding-left: 15px; pointer-events: none;
            transition: opacity 0.2s; white-space: nowrap;
        }
        body.light-theme .switch-knob { transform: translateX(86px); background: #f1c40f; }
        body.light-theme .switch-label { padding-left: 0; padding-right: 35px; }

        .lang-btn {
            background: var(--card-bg); border: 1px solid var(--card-border);
            padding: 6px 12px; border-radius: 20px; font-size: 13px;
            display: flex; align-items: center; gap: 5px; cursor: pointer;
            color: var(--text-main); backdrop-filter: blur(5px); width: fit-content;
        }

        .card-grid {
            flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch;
            padding-bottom: 50px; display: flex; flex-direction: column; gap: 16px;
        }
        .card-grid::-webkit-scrollbar { display: none; }

        .scenario-card {
            background-color: var(--card-bg); border-radius: 20px; padding: 24px;
            cursor: pointer; border-left: 6px solid transparent; flex-shrink: 0;
            transition: transform 0.1s, background-color 0.2s;
            backdrop-filter: blur(10px); border: 1px solid var(--card-border);
        }
        .scenario-card:active { transform: scale(0.98); opacity: 0.8; }
        .card-tabata { border-left-color: #ff453a; }
        .card-hiit { border-left-color: #ff9f0a; }
        .card-emom { border-left-color: #30d158; }
        .card-rest { border-left-color: #004e92; }
        .card-icon { font-size: 28px; margin-bottom: 10px; display: block; }
        .card-title { font-size: 20px; font-weight: 700; margin-bottom: 6px; }
        .card-desc { font-size: 13px; color: var(--text-sub); line-height: 1.4; }

        /* --- Timer Screen --- */
        .nav-bar {
            flex-shrink: 0; display: flex; align-items: center; justify-content: space-between;
            height: 50px; margin-bottom: 10px; transition: opacity 0.3s; position: relative;
        }
        .nav-bar.locked .btn-nav { opacity: 0; pointer-events: none; }
        
        .btn-nav {
            background: var(--card-bg); border: none; color: var(--text-main);
            padding: 8px 16px; border-radius: 20px; font-size: 15px;
            cursor: pointer; display: flex; align-items: center; gap: 5px;
            backdrop-filter: blur(5px); z-index: 2;
        }
        .btn-info-circle {
            width: 36px; height: 36px; border-radius: 50%; padding: 0;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-family: serif; font-size: 18px;
        }

        .total-time-badge {
            font-size: 15px; font-weight: 600; color: var(--text-main);
            background: var(--card-bg); padding: 6px 14px; border-radius: 12px;
            border: 1px solid var(--card-border); font-variant-numeric: tabular-nums;
            position: absolute; left: 50%; transform: translateX(-50%); 
            white-space: nowrap; z-index: 1;
        }

        .timer-content {
            flex: 1; display: flex; flex-direction: column;
            justify-content: center; align-items: center; min-height: 0; z-index: 10;
        }

        .mode-badge {
            background: var(--card-bg); padding: 6px 14px; border-radius: 12px;
            font-size: 14px; margin-bottom: 10px; color: var(--text-main); 
            border: 1px solid var(--card-border); backdrop-filter: blur(5px);
        }

        .status-text {
            font-size: clamp(24px, 5vh, 40px); font-weight: 700;
            margin-bottom: 5px; letter-spacing: 2px; text-shadow: 0 2px 15px rgba(0,0,0,0.3);
        }
        .timer-digits {
            font-size: clamp(90px, 18vh, 160px); font-weight: 800;
            font-variant-numeric: tabular-nums; line-height: 1; letter-spacing: -3px;
            text-shadow: 0 4px 30px rgba(0,0,0,0.3); transition: transform 0.1s;
        }
        .pulse { animation: pulseAnim 0.8s infinite; color: #fff; }
        @keyframes pulseAnim { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .rounds-text { 
            margin-top: 15px; font-size: 20px; color: var(--text-sub); font-weight: 500; 
            text-shadow: 0 1px 5px rgba(0,0,0,0.5);
        }

        .control-deck {
            flex-shrink: 0; display: flex; gap: 10px;
            margin-bottom: 20px; width: 100%; z-index: 10; transition: opacity 0.3s;
        }
        .deck-btn {
            flex: 1; background: var(--btn-deck); border-radius: 16px;
            padding: 12px 5px; border: 1px solid var(--card-border);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.2s; backdrop-filter: blur(5px);
        }
        .deck-btn:active { opacity: 0.7; }
        .deck-btn.active { border-color: rgba(255,255,255,0.8); background: rgba(255,255,255,0.3); }
        .deck-btn.disabled { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
        .deck-label { font-size: 12px; color: var(--text-main); font-weight: 500; margin-top: 4px;}
        .deck-sub { font-size: 10px; color: var(--text-sub); margin-top: 2px; }

        .action-area {
            flex-shrink: 0; margin-bottom: 30px; display: flex;
            gap: 12px; width: 100%; height: 75px; z-index: 10;
        }
        .btn-action {
            height: 100%; border-radius: 20px; border: none;
            font-size: 18px; font-weight: 700; cursor: pointer;
            transition: opacity 0.2s; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); gap: 8px;
        }
        .btn-action:active { opacity: 0.8; transform: scale(0.98); }
        .btn-reset { 
            flex: 1; background: #2c2c2e; color: #ff453a; 
            backdrop-filter: blur(10px); border: 2px solid rgba(255,69,58,0.2); font-size: 16px; 
        }
        .btn-start { flex: 2; background: #fff; color: #000; font-size: 20px;}
        body.light-theme .btn-reset { background: #ecf0f1; }

        /* Modal Overlay */
        .modal-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100;
            display: flex; justify-content: center; align-items: flex-end;
            backdrop-filter: blur(8px);
        }
        .modal-content {
            background: var(--modal-bg); color: var(--modal-text);
            width: 100%; max-height: 90%;
            border-top-left-radius: 24px; border-top-right-radius: 24px;
            padding: 24px; box-sizing: border-box; overflow-y: auto;
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .modal-title { font-size: 20px; font-weight: 700; }
        .btn-close { background: none; border: none; color: #0a84ff; font-size: 16px; font-weight: 600; cursor: pointer;}
        
        .lang-list { display: flex; flex-direction: column; gap: 10px; }
        .lang-item {
            padding: 15px; background: var(--lang-item-bg); border-radius: 12px;
            font-size: 16px; cursor: pointer; display: flex; justify-content: space-between;
        }
        .lang-item.selected { border: 2px solid #0a84ff; color: #0a84ff; font-weight: bold; }

        /* Pro Info Styling */
        .modal-body-text { font-size: 15px; line-height: 1.7; color: var(--modal-text); opacity: 0.9; }
        .modal-body-text h3 { margin-bottom: 8px; font-size: 18px; color: #0a84ff; }
        .modal-body-text ul { padding-left: 20px; margin-bottom: 15px; }
        .modal-body-text li { margin-bottom: 5px; }

        .modal-total-time {
            text-align: center; margin-bottom: 20px; color: var(--text-sub); font-size: 14px;
            background: var(--setting-row-bg); padding: 10px; border-radius: 10px;
        }
        .setting-group-title { font-size: 14px; color: #8e8e93; margin-bottom: 10px; margin-top: 20px; font-weight: 600; text-transform: uppercase;}
        .setting-row {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 12px; padding: 12px; background: var(--setting-row-bg); border-radius: 12px;
        }
        .time-input-group { display: flex; align-items: center; gap: 5px; }
        .input-num {
            background: var(--input-bg); border: 1px solid var(--input-border); color: var(--modal-text);
            width: 50px; padding: 8px 0; border-radius: 8px; text-align: center; font-size: 16px;
        }
        .time-label { font-size: 14px; color: var(--text-sub); }
        .btn-restore {
            width: 100%; padding: 15px; background: transparent;
            border: 1px solid #ff453a; color: #ff453a;
            border-radius: 12px; font-size: 16px; margin-top: 20px; margin-bottom: 20px; cursor: pointer;
        }
    </style>
</head>
<body class="">

<div id="app-container">
    
    <div id="home-screen" class="screen">
        <div class="header">
            <div class="header-text">
                <div class="app-title" data-i18n="app_title">SmartTimer</div>
                <div class="app-subtitle" data-i18n="app_subtitle">é¸æ“‡ä½ çš„è¨“ç·´æ¨¡å¼</div>
            </div>
            <div class="header-controls">
                <div class="theme-switch" onclick="toggleTheme()">
                    <div class="switch-knob"></div>
                    <span class="switch-label" id="theme-text">æš—è‰²é¢¨æ ¼</span>
                </div>
                <button class="lang-btn" onclick="openLangModal()">
                    <span>ğŸŒ</span> <span id="lang-display">ç¹é«”ä¸­æ–‡</span>
                </button>
            </div>
        </div>

        <div class="card-grid">
            <div class="scenario-card card-tabata" onclick="selectMode('tabata')">
                <span class="card-icon">ğŸ”¥</span>
                <div class="card-title" data-i18n="mode_tabata_title">æ¥µé€Ÿç‡ƒè„‚ (Tabata)</div>
                <div class="card-desc" data-i18n="mode_tabata_desc">Tabata ç¶“å…¸é…ç½®</div>
            </div>
            <div class="scenario-card card-hiit" onclick="selectMode('hiit')">
                <span class="card-icon">ğŸƒ</span>
                <div class="card-title" data-i18n="mode_hiit_title">é«˜å¼·åº¦é–“æ­‡ (HIIT)</div>
                <div class="card-desc" data-i18n="mode_hiit_desc">é©åˆä¸€èˆ¬æœ‰æ°§å¾ªç’°</div>
            </div>
            <div class="scenario-card card-emom" onclick="selectMode('emom')">
                <span class="card-icon">âš¡</span>
                <div class="card-title" data-i18n="mode_emom_title">å¾ªç’°æŒ‘æˆ° (EMOM)</div>
                <div class="card-desc" data-i18n="mode_emom_desc">æ¯åˆ†é˜æ•´é»å¾ªç’°</div>
            </div>
            <div class="scenario-card card-rest" onclick="selectMode('gym')">
                <span class="card-icon">ğŸ‹ï¸</span>
                <div class="card-title" data-i18n="mode_gym_title">é‡é‡è¨“ç·´ (Gym)</div>
                <div class="card-desc" data-i18n="mode_gym_desc">å«è¨“ç·´æ™‚é–“èˆ‡çµ„é–“ä¼‘æ¯</div>
            </div>
            <div style="height: 20px;"></div>
        </div>
    </div>

    <div id="timer-screen" class="screen hidden">
        <div class="nav-bar" id="navBar">
            <button class="btn-nav" onclick="goBack()">â® <span data-i18n="btn_back">è¿”å›</span></button>
            <div class="total-time-badge" id="mainRemainingTime">--:--</div>
            <button class="btn-nav btn-info-circle" onclick="openInfoModal()">i</button>
        </div>

        <div class="timer-content">
            <div class="mode-badge" id="modeBadge">Tabata</div>
            <div class="status-text" id="statusText">æº–å‚™</div>
            <div class="timer-digits" id="timerDigits">00:00</div>
            <div class="rounds-text" id="roundsText">Round 1/8</div>
        </div>

        <div class="control-deck">
            <div class="deck-btn" onclick="toggleSoundMode()">
                <div class="deck-icon" id="btn-sound-icon">ğŸ””</div>
                <div class="deck-label" id="btn-sound-text" data-i18n="sound_beep">éŸ³æ•ˆæ¨¡å¼</div>
            </div>
            <div class="deck-btn lockable" id="btn-warmup" onclick="toggleWarmupDirect()">
                <div class="deck-icon">ğŸŒ¡ï¸</div>
                <div class="deck-label" data-i18n="btn_warmup">æš–èº«é–‹é—œ</div>
                <div class="deck-sub" id="btn-warmup-sub">é—œé–‰</div>
            </div>
            <div class="deck-btn lockable" onclick="openSettings()">
                <div class="deck-icon">âš™ï¸</div>
                <div class="deck-label" data-i18n="btn_custom">è‡ªå®šç¾©</div>
            </div>
        </div>

        <div class="action-area">
            <button class="btn-action btn-reset" onclick="resetTimer()"><span data-i18n="btn_reset">â¹ çµæŸ / é‡ç½®</span></button>
            <button class="btn-action btn-start" id="actionBtn" onclick="toggleTimerState()"><span data-i18n="btn_start">â–¶ é–‹å§‹</span></button>
        </div>
    </div>

    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" data-i18n="modal_settings_title">è©³ç´°è¨­å®š</div>
                <button class="btn-close" onclick="closeSettings()" data-i18n="btn_done">å®Œæˆ</button>
            </div>
            
            <div class="modal-total-time" id="modalTotalTime">--:--</div>

            <div class="setting-group-title" data-i18n="group_prep">å‰ç½®æº–å‚™</div>
            <div class="setting-row">
                <span class="setting-label" data-i18n="label_prep">æº–å‚™æ™‚é–“</span>
                <div class="time-input-group">
                    <input type="number" class="input-num" id="set-prep-min" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_min">åˆ†</span>
                    <input type="number" class="input-num" id="set-prep-sec" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_sec">ç§’</span>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label" data-i18n="label_warmup">æš–èº«æ™‚é–“</span>
                <div class="time-input-group">
                    <input type="number" class="input-num" id="set-warmup-min" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_min">åˆ†</span>
                    <input type="number" class="input-num" id="set-warmup-sec" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_sec">ç§’</span>
                </div>
            </div>

            <div class="setting-group-title" data-i18n="group_work">æ­£å¼è¨“ç·´</div>
            <div class="setting-row" id="row-work">
                <span class="setting-label" data-i18n="label_work">é‹å‹•/è¨“ç·´</span>
                <div class="time-input-group">
                    <input type="number" class="input-num" id="set-work-min" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_min">åˆ†</span>
                    <input type="number" class="input-num" id="set-work-sec" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_sec">ç§’</span>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label" data-i18n="label_rest">ä¼‘æ¯æ™‚é–“</span>
                <div class="time-input-group">
                    <input type="number" class="input-num" id="set-rest-min" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_min">åˆ†</span>
                    <input type="number" class="input-num" id="set-rest-sec" oninput="validateInput(this); liveUpdateTotal()">
                    <span class="time-label" data-i18n="unit_sec">ç§’</span>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label" data-i18n="label_rounds">ç¸½çµ„æ•¸ (Rounds)</span>
                <div class="time-input-group">
                    <input type="number" class="input-num" id="set-rounds" oninput="validateInput(this); liveUpdateTotal()">
                </div>
            </div>

            <button class="btn-restore" onclick="restoreDefaults()" data-i18n="btn_restore">â†» é‚„åŸé è¨­å€¼</button>
        </div>
    </div>

    <div id="lang-modal" class="modal-overlay hidden">
        <div class="modal-content" style="height:auto; max-height: 70%;">
            <div class="modal-header">
                <div class="modal-title" data-i18n="modal_lang_title">é¸æ“‡èªè¨€</div>
                <button class="btn-close" onclick="closeLangModal()">X</button>
            </div>
            <div class="lang-list">
                <div class="lang-item" onclick="setLanguage('zh-TW')">ç¹é«”ä¸­æ–‡</div>
                <div class="lang-item" onclick="setLanguage('zh-CN')">ç®€ä½“ä¸­æ–‡</div>
                <div class="lang-item" onclick="setLanguage('en')">English</div>
                <div class="lang-item" onclick="setLanguage('ja')">æ—¥æœ¬èª</div>
                <div class="lang-item" onclick="setLanguage('ko')">í•œêµ­ì–´</div>
            </div>
        </div>
    </div>

    <div id="info-modal" class="modal-overlay hidden">
        <div class="modal-content" style="height: auto; max-height: 70%;">
            <div class="modal-header">
                <div class="modal-title" id="info-title">é—œæ–¼</div>
                <button class="btn-close" onclick="closeInfoModal()" data-i18n="btn_close">é—œé–‰</button>
            </div>
            <div class="modal-body-text" id="info-content"></div>
        </div>
    </div>

</div>

<script>
    // --- 5 Languages with Professional Content ---
    const translations = {
        'zh-TW': {
            lang_name: "ç¹é«”ä¸­æ–‡",
            app_title: "SmartTimer", app_subtitle: "é¸æ“‡ä½ çš„è¨“ç·´æ¨¡å¼",
            mode_tabata_title: "æ¥µé€Ÿç‡ƒè„‚ (Tabata)", mode_tabata_desc: "20ç§’é‹å‹• / 10ç§’ä¼‘æ¯",
            mode_hiit_title: "é«˜å¼·åº¦é–“æ­‡ (HIIT)", mode_hiit_desc: "é©åˆä¸€èˆ¬æœ‰æ°§å¾ªç’°",
            mode_emom_title: "å¾ªç’°æŒ‘æˆ° (EMOM)", mode_emom_desc: "æ¯åˆ†é˜æ•´é»å¾ªç’°",
            mode_gym_title: "é‡é‡è¨“ç·´ (Gym)", mode_gym_desc: "å«è¨“ç·´æ™‚é–“èˆ‡çµ„é–“ä¼‘æ¯",
            btn_back: "è¿”å›", btn_reset: "â¹ çµæŸ / é‡ç½®", btn_start: "â–¶ é–‹å§‹", btn_pause: "â¸ æš«åœ",
            btn_warmup: "æš–èº«é–‹é—œ", btn_custom: "è‡ªå®šç¾©", btn_done: "å®Œæˆ", btn_restore: "â†» é‚„åŸé è¨­å€¼", btn_close: "é—œé–‰",
            label_remaining: "å‰©é¤˜", label_total_est: "é ä¼°æ™‚é–“ç¸½é•·", label_off: "é—œé–‰",
            modal_settings_title: "è©³ç´°è¨­å®š", modal_lang_title: "é¸æ“‡èªè¨€",
            group_prep: "å‰ç½®æº–å‚™", group_work: "æ­£å¼è¨“ç·´",
            label_prep: "æº–å‚™æ™‚é–“", label_warmup: "æš–èº«æ™‚é–“", label_work: "é‹å‹•/è¨“ç·´", label_rest: "ä¼‘æ¯æ™‚é–“", label_rounds: "ç¸½çµ„æ•¸",
            unit_min: "åˆ†", unit_sec: "ç§’",
            sound_beep: "éŸ³æ•ˆæ¨¡å¼", sound_voice: "äººè²æ¨¡å¼", sound_mute: "éœéŸ³æ¨¡å¼",
            phase_prep: "æº–å‚™", phase_warmup: "æš–èº«", phase_work: "é‹å‹•ä¸­", phase_gym_work: "è¨“ç·´ä¸­",
            phase_rest: "ä¼‘æ¯ / ç·©å’Œ", phase_gym_rest: "çµ„é–“ä¼‘æ¯", phase_finish: "å®Œæˆ",
            phase_start_warmup: "é–‹å§‹æš–èº«", phase_start_work: "é‹å‹•é–‹å§‹", phase_gym_start: "è¨“ç·´é–‹å§‹", phase_start_rest: "ä¼‘æ¯ä¸€ä¸‹", phase_finish_train: "è¨“ç·´çµæŸ",
            theme_dark: "æš—è‰²é¢¨æ ¼", theme_light: "äº®è‰²é¢¨æ ¼",
            info_tabata: "<h3>Tabata è¨“ç·´æ³•</h3><p>ç”±æ—¥æœ¬ç”°ç•‘æ³‰ (Izumi Tabata) æ•™æˆç ”ç™¼ã€‚æ ¸å¿ƒæ˜¯ã€Œ20ç§’é«˜å¼·åº¦é‹å‹• + 10ç§’ä¼‘æ¯ã€ï¼Œé‡è¤‡8çµ„ï¼Œå…±4åˆ†é˜ã€‚</p><ul><li><b>å„ªé»ï¼š</b>èƒ½åœ¨æ¥µçŸ­æ™‚é–“å…§åŒæ™‚æå‡æœ‰æ°§èˆ‡ç„¡æ°§èƒ½åŠ›ã€‚</li><li><b>å¼·åº¦ï¼š</b>å¿…é ˆé”åˆ°æœ€å¤§æ”æ°§é‡çš„ 170% (å…¨åŠ›è¡åˆº)ã€‚</li></ul>",
            info_hiit: "<h3>HIIT é«˜å¼·åº¦é–“æ­‡</h3><p>äº¤æ›¿é€²è¡Œã€ŒçŸ­æ™‚é–“é«˜å¼·åº¦é‹å‹•ã€èˆ‡ã€ŒçŸ­æš«æ¢å¾©æœŸã€ã€‚</p><ul><li><b>EPOC æ•ˆæ‡‰ï¼š</b>é‹å‹•å¾Œèº«é«”æœƒæŒçºŒæ¶ˆè€—ç†±é‡ (å¾Œç‡ƒæ•ˆæ‡‰)ã€‚</li><li><b>é©ç”¨ï¼š</b>è·‘æ­¥ã€å–®è»Šã€æ³¢æ¯”è·³ç­‰å…¨èº«æ€§é‹å‹•ã€‚</li></ul>",
            info_emom: "<h3>EMOM æŒ‘æˆ°</h3><p>Every Minute on the Minute (æ¯åˆ†é˜æ•´é»é–‹å§‹)ã€‚</p><ul><li><b>è¦å‰‡ï¼š</b>æ¯åˆ†é˜é–‹å§‹æ™‚åšæŒ‡å®šæ¬¡æ•¸å‹•ä½œï¼Œåšå®Œå‰©ä¸‹çš„æ™‚é–“å°±æ˜¯ä¼‘æ¯ã€‚</li><li><b>ç­–ç•¥ï¼š</b>åšå¾—è¶Šå¿«ï¼Œä¼‘æ¯è¶Šä¹…ï¼Œä½†å¿ƒç‡è¶Šé«˜ï¼›åšå¾—æ…¢ï¼Œä¼‘æ¯å°‘ï¼Œå®¹æ˜“åŠ›ç«­ã€‚</li></ul>",
            info_gym: "<h3>é‡é‡è¨“ç·´è¨ˆæ™‚</h3><p>å°ˆç‚ºå¥èº«æˆ¿é‡è¨“è¨­è¨ˆï¼ŒåŒ…å«ã€Œè¨“ç·´æ™‚é–“ (Work)ã€èˆ‡ã€Œçµ„é–“ä¼‘æ¯ (Rest)ã€ã€‚</p><ul><li><b>ATP-PC ç³»çµ±ï¼š</b>ä¸€èˆ¬å»ºè­°çµ„é–“ä¼‘æ¯ 90-120 ç§’ï¼Œè®“è‚Œè‚‰èƒ½é‡ç³»çµ±æ¢å¾©ã€‚</li><li><b>ç¯€å¥æ§åˆ¶ï¼š</b>æ­¤æ¨¡å¼å¯å¹«åŠ©ä½ ç¶­æŒæ¯çµ„çš„è¨“ç·´å¯†åº¦ã€‚</li></ul>"
        },
        'zh-CN': {
            lang_name: "ç®€ä½“ä¸­æ–‡",
            app_title: "SmartTimer", app_subtitle: "é€‰æ‹©ä½ çš„è®­ç»ƒæ¨¡å¼",
            mode_tabata_title: "æé€Ÿç‡ƒè„‚ (Tabata)", mode_tabata_desc: "20ç§’è¿åŠ¨ / 10ç§’ä¼‘æ¯",
            mode_hiit_title: "é«˜å¼ºåº¦é—´æ­‡ (HIIT)", mode_hiit_desc: "é€‚åˆä¸€èˆ¬æœ‰æ°§å¾ªç¯",
            mode_emom_title: "å¾ªç¯æŒ‘æˆ˜ (EMOM)", mode_emom_desc: "æ¯åˆ†é’Ÿæ•´ç‚¹å¾ªç¯",
            mode_gym_title: "é‡é‡è®­ç»ƒ (Gym)", mode_gym_desc: "å«è®­ç»ƒæ—¶é—´ä¸ç»„é—´ä¼‘æ¯",
            btn_back: "è¿”å›", btn_reset: "â¹ ç»“æŸ / é‡ç½®", btn_start: "â–¶ å¼€å§‹", btn_pause: "â¸ æš‚åœ",
            btn_warmup: "çƒ­èº«å¼€å…³", btn_custom: "è‡ªå®šä¹‰", btn_done: "å®Œæˆ", btn_restore: "â†» è¿˜åŸé»˜è®¤å€¼", btn_close: "å…³é—­",
            label_remaining: "å‰©ä½™", label_total_est: "é¢„ä¼°æ€»æ—¶é•¿", label_off: "å…³é—­",
            modal_settings_title: "è¯¦ç»†è®¾å®š", modal_lang_title: "é€‰æ‹©è¯­è¨€",
            group_prep: "å‰ç½®å‡†å¤‡", group_work: "æ­£å¼è®­ç»ƒ",
            label_prep: "å‡†å¤‡æ—¶é—´", label_warmup: "çƒ­èº«æ—¶é—´", label_work: "è¿åŠ¨/è®­ç»ƒ", label_rest: "ä¼‘æ¯æ—¶é—´", label_rounds: "æ€»ç»„æ•°",
            unit_min: "åˆ†", unit_sec: "ç§’",
            sound_beep: "éŸ³æ•ˆæ¨¡å¼", sound_voice: "äººå£°æ¨¡å¼", sound_mute: "é™éŸ³æ¨¡å¼",
            phase_prep: "å‡†å¤‡", phase_warmup: "çƒ­èº«", phase_work: "è¿åŠ¨ä¸­", phase_gym_work: "è®­ç»ƒä¸­",
            phase_rest: "ä¼‘æ¯ / ç¼“å’Œ", phase_gym_rest: "ç»„é—´ä¼‘æ¯", phase_finish: "å®Œæˆ",
            phase_start_warmup: "å¼€å§‹çƒ­èº«", phase_start_work: "è¿åŠ¨å¼€å§‹", phase_gym_start: "è®­ç»ƒå¼€å§‹", phase_start_rest: "ä¼‘æ¯ä¸€ä¸‹", phase_finish_train: "è®­ç»ƒç»“æŸ",
            theme_dark: "æš—è‰²é£æ ¼", theme_light: "äº®è‰²é£æ ¼",
            info_tabata: "<h3>Tabata è®­ç»ƒæ³•</h3><p>ç”±æ—¥æœ¬ç”°ç•‘æ³‰ (Izumi Tabata) æ•™æˆç ”å‘ã€‚æ ¸å¿ƒæ˜¯ã€Œ20ç§’é«˜å¼ºåº¦è¿åŠ¨ + 10ç§’ä¼‘æ¯ã€ï¼Œé‡å¤8ç»„ã€‚</p><ul><li><b>ä¼˜ç‚¹ï¼š</b>æçŸ­æ—¶é—´å†…æå‡æœ‰æ°§ä¸æ— æ°§èƒ½åŠ›ã€‚</li><li><b>å¼ºåº¦ï¼š</b>éœ€è¾¾åˆ°æœ€å¤§æ‘„æ°§é‡çš„ 170%ã€‚</li></ul>",
            info_hiit: "<h3>HIIT é«˜å¼ºåº¦é—´æ­‡</h3><p>äº¤æ›¿è¿›è¡Œã€Œé«˜å¼ºåº¦è¿åŠ¨ã€ä¸ã€ŒçŸ­æš‚æ¢å¤ã€ã€‚</p><ul><li><b>EPOC æ•ˆåº”ï¼š</b>è¿åŠ¨åæŒç»­æ¶ˆè€—çƒ­é‡ (åç‡ƒæ•ˆåº”)ã€‚</li><li><b>é€‚ç”¨ï¼š</b>è·‘æ­¥ã€å•è½¦ã€æ³¢æ¯”è·³ç­‰ã€‚</li></ul>",
            info_emom: "<h3>EMOM æŒ‘æˆ˜</h3><p>Every Minute on the Minuteã€‚</p><ul><li><b>è§„åˆ™ï¼š</b>æ¯åˆ†é’Ÿå¼€å§‹åšæŒ‡å®šåŠ¨ä½œï¼Œåšå®Œå‰©ä½™æ—¶é—´å³ä¸ºä¼‘æ¯ã€‚</li><li><b>ç­–ç•¥ï¼š</b>åšè¶Šå¿«ä¼‘æ¯è¶Šä¹…ï¼Œä½†å¿ƒç‡è¶Šé«˜ã€‚</li></ul>",
            info_gym: "<h3>é‡é‡è®­ç»ƒè®¡æ—¶</h3><p>åŒ…å«ã€Œè®­ç»ƒæ—¶é—´ã€ä¸ã€Œç»„é—´ä¼‘æ¯ã€ã€‚</p><ul><li><b>èƒ½é‡æ¢å¤ï¼š</b>å»ºè®®ç»„é—´ä¼‘æ¯ 90-120 ç§’ä»¥æ¢å¤ ATP-PC ç³»ç»Ÿã€‚</li><li><b>èŠ‚å¥æ§åˆ¶ï¼š</b>ç»´æŒæ¯ç»„è®­ç»ƒå¯†åº¦ï¼Œé¿å…ä¼‘æ¯è¿‡ä¹…ã€‚</li></ul>"
        },
        'en': {
            lang_name: "English",
            app_title: "SmartTimer", app_subtitle: "Select Workout Mode",
            mode_tabata_title: "Tabata Burn", mode_tabata_desc: "20s Work / 10s Rest",
            mode_hiit_title: "HIIT Intervals", mode_hiit_desc: "High Intensity Training",
            mode_emom_title: "EMOM Challenge", mode_emom_desc: "Every Minute on the Minute",
            mode_gym_title: "Weight Training", mode_gym_desc: "Sets & Rest Timer",
            btn_back: "Back", btn_reset: "â¹ End / Reset", btn_start: "â–¶ Start", btn_pause: "â¸ Pause",
            btn_warmup: "Warm-up", btn_custom: "Settings", btn_done: "Done", btn_restore: "â†» Reset Defaults", btn_close: "Close",
            label_remaining: "Remain", label_total_est: "Est. Total Time", label_off: "Off",
            modal_settings_title: "Settings", modal_lang_title: "Select Language",
            group_prep: "Preparation", group_work: "Workout",
            label_prep: "Get Ready", label_warmup: "Warm-up", label_work: "Work", label_rest: "Rest", label_rounds: "Rounds",
            unit_min: "m", unit_sec: "s",
            sound_beep: "Beep Mode", sound_voice: "Voice Mode", sound_mute: "Mute Mode",
            phase_prep: "Get Ready", phase_warmup: "Warm Up", phase_work: "Work", phase_gym_work: "Training",
            phase_rest: "Rest", phase_gym_rest: "Rest", phase_finish: "Done",
            phase_start_warmup: "Start Warmup", phase_start_work: "Start Work", phase_gym_start: "Start Training", phase_start_rest: "Rest Now", phase_finish_train: "Workout Complete",
            theme_dark: "Dark Mode", theme_light: "Light Mode",
            info_tabata: "<h3>Tabata Protocol</h3><p>Developed by Dr. Izumi Tabata. 20s ultra-intense work + 10s rest, x8 rounds.</p><ul><li><b>Benefit:</b> Improves both aerobic and anaerobic systems.</li><li><b>Intensity:</b> Aim for 170% VO2 max.</li></ul>",
            info_hiit: "<h3>HIIT Intervals</h3><p>High-Intensity Interval Training. Short bursts of intense activity mixed with recovery.</p><ul><li><b>EPOC:</b> Triggers the 'afterburn' effect, burning calories post-workout.</li></ul>",
            info_emom: "<h3>EMOM Challenge</h3><p>Every Minute on the Minute.</p><ul><li><b>Rule:</b> Complete X reps at the start of the minute. Remaining time is rest.</li><li><b>Strategy:</b> Faster reps = more rest but higher heart rate.</li></ul>",
            info_gym: "<h3>Weight Training</h3><p>Tracks 'Work Time' (Set) and 'Rest Time'.</p><ul><li><b>Recovery:</b> 90-120s rest is optimal for ATP-PC system recovery.</li><li><b>Focus:</b> Keeps your workout density consistent.</li></ul>"
        },
        'ja': {
            lang_name: "æ—¥æœ¬èª",
            app_title: "SmartTimer", app_subtitle: "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰é¸æŠ",
            mode_tabata_title: "ã‚¿ãƒã‚¿å¼", mode_tabata_desc: "20ç§’é‹å‹• / 10ç§’ä¼‘æ†©",
            mode_hiit_title: "HIIT", mode_hiit_desc: "é«˜å¼·åº¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",
            mode_emom_title: "EMOM", mode_emom_desc: "1åˆ†é–“ã”ã¨ã®ã‚»ãƒƒãƒˆ",
            mode_gym_title: "ç­‹åŠ›ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°", mode_gym_desc: "ã‚»ãƒƒãƒˆã¨ä¼‘æ†©ã®ã‚¿ã‚¤ãƒãƒ¼",
            btn_back: "æˆ»ã‚‹", btn_reset: "â¹ çµ‚äº† / ãƒªã‚»ãƒƒãƒˆ", btn_start: "â–¶ é–‹å§‹", btn_pause: "â¸ ä¸€æ™‚åœæ­¢",
            btn_warmup: "ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—", btn_custom: "è¨­å®š", btn_done: "å®Œäº†", btn_restore: "â†» åˆæœŸåŒ–", btn_close: "é–‰ã˜ã‚‹",
            label_remaining: "æ®‹ã‚Š", label_total_est: "äºˆæƒ³åˆè¨ˆæ™‚é–“", label_off: "ã‚ªãƒ•",
            modal_settings_title: "è©³ç´°è¨­å®š", modal_lang_title: "è¨€èªé¸æŠ",
            group_prep: "æº–å‚™", group_work: "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",
            label_prep: "æº–å‚™æ™‚é–“", label_warmup: "ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—", label_work: "é‹å‹•", label_rest: "ä¼‘æ†©", label_rounds: "ã‚»ãƒƒãƒˆæ•°",
            unit_min: "åˆ†", unit_sec: "ç§’",
            sound_beep: "ãƒ“ãƒ¼ãƒ—éŸ³", sound_voice: "éŸ³å£°ã‚¬ã‚¤ãƒ‰", sound_mute: "ãƒŸãƒ¥ãƒ¼ãƒˆ",
            phase_prep: "æº–å‚™", phase_warmup: "ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—", phase_work: "é‹å‹•ä¸­", phase_gym_work: "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­",
            phase_rest: "ä¼‘æ†©", phase_gym_rest: "ã‚»ãƒƒãƒˆé–“ä¼‘æ†©", phase_finish: "å®Œäº†",
            phase_start_warmup: "ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—é–‹å§‹", phase_start_work: "é‹å‹•é–‹å§‹", phase_gym_start: "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–‹å§‹", phase_start_rest: "ä¼‘æ†©ã—ã¦ãã ã•ã„", phase_finish_train: "ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°çµ‚äº†",
            theme_dark: "ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰", theme_light: "ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰",
            info_tabata: "<h3>ã‚¿ãƒã‚¿å¼ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h3><p>ç«‹å‘½é¤¨å¤§å­¦ã®ç”°ç•‘æ³‰æ•™æˆãŒè€ƒæ¡ˆã€‚20ç§’ã®é‹å‹•ã¨10ç§’ã®ä¼‘æ†©ã‚’8ã‚»ãƒƒãƒˆã€‚</p><ul><li><b>åŠ¹æœï¼š</b>æœ‰é…¸ç´ ãƒ»ç„¡é…¸ç´ èƒ½åŠ›ã‚’åŒæ™‚ã«å‘ä¸Šã€‚</li><li><b>å¼·åº¦ï¼š</b>å…¨åŠ›ã§è¿½ã„è¾¼ã‚€ã“ã¨ãŒé‡è¦ã§ã™ã€‚</li></ul>",
            info_hiit: "<h3>HIIT (é«˜å¼·åº¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«)</h3><p>é«˜å¼·åº¦ã®é‹å‹•ã¨ä¸å®Œå…¨å›å¾©ã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</p><ul><li><b>ã‚¢ãƒ•ã‚¿ãƒ¼ãƒãƒ¼ãƒ³ï¼š</b>é‹å‹•å¾Œã‚‚ã‚«ãƒ­ãƒªãƒ¼æ¶ˆè²»ãŒç¶šãã¾ã™ï¼ˆEPOCåŠ¹æœï¼‰ã€‚</li></ul>",
            info_emom: "<h3>EMOM (1åˆ†é–“èµ°)</h3><p>1åˆ†ã”ã¨ã«æ±ºã‚ã‚‰ã‚ŒãŸå›æ•°ã®å‹•ä½œã‚’è¡Œã„ã¾ã™ã€‚</p><ul><li><b>ãƒ«ãƒ¼ãƒ«ï¼š</b>æ—©ãçµ‚ã‚ã‚Œã°æ®‹ã‚Šã¯ä¼‘æ†©ã€‚ãƒšãƒ¼ã‚¹é…åˆ†ãŒéµã¨ãªã‚Šã¾ã™ã€‚</li></ul>",
            info_gym: "<h3>ç­‹ãƒˆãƒ¬ç”¨ã‚¿ã‚¤ãƒãƒ¼</h3><p>ã‚»ãƒƒãƒˆä¸­ã®æ™‚é–“ã¨ä¼‘æ†©æ™‚é–“ã‚’ç®¡ç†ã€‚</p><ul><li><b>å›å¾©ï¼š</b>ATP-PCç³»ã®å›å¾©ã«ã¯90ã€œ120ç§’ã®ä¼‘æ†©ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚</li><li><b>é›†ä¸­ï¼š</b>ã ã‚‰ã ã‚‰ã¨ä¼‘æ†©ã™ã‚‹ã®ã‚’é˜²ãã¾ã™ã€‚</li></ul>"
        },
        'ko': {
            lang_name: "í•œêµ­ì–´",
            app_title: "SmartTimer", app_subtitle: "ìš´ë™ ëª¨ë“œ ì„ íƒ",
            mode_tabata_title: "íƒ€ë°”íƒ€", mode_tabata_desc: "20ì´ˆ ìš´ë™ / 10ì´ˆ íœ´ì‹",
            mode_hiit_title: "HIIT", mode_hiit_desc: "ê³ ê°•ë„ ì¸í„°ë²Œ íŠ¸ë ˆì´ë‹",
            mode_emom_title: "EMOM", mode_emom_desc: "1ë¶„ ë‹¨ìœ„ ë°˜ë³µ",
            mode_gym_title: "ì›¨ì´íŠ¸ íŠ¸ë ˆì´ë‹", mode_gym_desc: "ì„¸íŠ¸ ë° íœ´ì‹ íƒ€ì´ë¨¸",
            btn_back: "ë’¤ë¡œ", btn_reset: "â¹ ì¢…ë£Œ / ì´ˆê¸°í™”", btn_start: "â–¶ ì‹œì‘", btn_pause: "â¸ ì¼ì‹œì •ì§€",
            btn_warmup: "ì›œì—…", btn_custom: "ì„¤ì •", btn_done: "ì™„ë£Œ", btn_restore: "â†» ì´ˆê¸°í™”", btn_close: "ë‹«ê¸°",
            label_remaining: "ë‚¨ì€ ì‹œê°„", label_total_est: "ì˜ˆìƒ ì´ ì‹œê°„", label_off: "êº¼ì§",
            modal_settings_title: "ìƒì„¸ ì„¤ì •", modal_lang_title: "ì–¸ì–´ ì„ íƒ",
            group_prep: "ì¤€ë¹„", group_work: "ìš´ë™",
            label_prep: "ì¤€ë¹„ ì‹œê°„", label_warmup: "ì›œì—… ì‹œê°„", label_work: "ìš´ë™", label_rest: "íœ´ì‹", label_rounds: "ì„¸íŠ¸ ìˆ˜",
            unit_min: "ë¶„", unit_sec: "ì´ˆ",
            sound_beep: "ë¹„í”„ìŒ", sound_voice: "ìŒì„± ëª¨ë“œ", sound_mute: "ë¬´ìŒ",
            phase_prep: "ì¤€ë¹„", phase_warmup: "ì›œì—…", phase_work: "ìš´ë™ ì¤‘", phase_gym_work: "íŠ¸ë ˆì´ë‹ ì¤‘",
            phase_rest: "íœ´ì‹", phase_gym_rest: "ì„¸íŠ¸ ê°„ íœ´ì‹", phase_finish: "ì™„ë£Œ",
            phase_start_warmup: "ì›œì—… ì‹œì‘", phase_start_work: "ìš´ë™ ì‹œì‘", phase_gym_start: "íŠ¸ë ˆì´ë‹ ì‹œì‘", phase_start_rest: "íœ´ì‹í•˜ì„¸ìš”", phase_finish_train: "ìš´ë™ ì¢…ë£Œ",
            theme_dark: "ë‹¤í¬ ëª¨ë“œ", theme_light: "ë¼ì´íŠ¸ ëª¨ë“œ",
            info_tabata: "<h3>íƒ€ë°”íƒ€ íŠ¸ë ˆì´ë‹</h3><p>20ì´ˆ ê³ ê°•ë„ ìš´ë™ + 10ì´ˆ íœ´ì‹, 8ì„¸íŠ¸ ë°˜ë³µ.</p><ul><li><b>íš¨ê³¼:</b> ë‹¨ì‹œê°„ì— ìœ ì‚°ì†Œ ë° ë¬´ì‚°ì†Œ ëŠ¥ë ¥ í–¥ìƒ.</li></ul>",
            info_hiit: "<h3>HIIT (ê³ ê°•ë„ ì¸í„°ë²Œ)</h3><p>ì§§ì€ ì‹œê°„ì˜ ê³ ê°•ë„ ìš´ë™ê³¼ íœ´ì‹ì„ ë°˜ë³µí•©ë‹ˆë‹¤.</p><ul><li><b>EPOC:</b> ìš´ë™ í›„ì—ë„ ì¹¼ë¡œë¦¬ê°€ ê³„ì† ì†Œëª¨ë©ë‹ˆë‹¤.</li></ul>",
            info_emom: "<h3>EMOM ì±Œë¦°ì§€</h3><p>1ë¶„ë§ˆë‹¤ ì •í•´ì§„ ë™ì‘ ìˆ˜í–‰.</p><ul><li><b>ê·œì¹™:</b> ë™ì‘ì„ ë¹¨ë¦¬ ëë‚¼ìˆ˜ë¡ íœ´ì‹ ì‹œê°„ì´ ê¸¸ì–´ì§‘ë‹ˆë‹¤.</li></ul>",
            info_gym: "<h3>ì›¨ì´íŠ¸ íŠ¸ë ˆì´ë‹</h3><p>ì„¸íŠ¸ ìˆ˜í–‰ ì‹œê°„ê³¼ íœ´ì‹ ì‹œê°„ì„ ê´€ë¦¬.</p><ul><li><b>íšŒë³µ:</b> ATP-PC ì‹œìŠ¤í…œ íšŒë³µì„ ìœ„í•´ 90~120ì´ˆ íœ´ì‹ ê¶Œì¥.</li></ul>"
        }
    };

    let currentLang = localStorage.getItem('smartTimerLang') || 'zh-TW';

    // --- Helper Functions ---
    function t(key) { return translations[currentLang][key] || key; }
    
    // --- Modal Logic (Click Outside) ---
    document.querySelectorAll('.modal-overlay').forEach(el => {
        el.addEventListener('click', function(e) {
            if (e.target === this) {
                if(this.id === 'settings-modal') closeSettings();
                if(this.id === 'info-modal') closeInfoModal();
                if(this.id === 'lang-modal') closeLangModal();
            }
        });
    });

    // --- Input Safety (Clamping) ---
    function validateInput(el) {
        // Remove leading zeros if user types
        if(el.value.length > 1 && el.value.startsWith('0')) el.value = parseInt(el.value);

        let max = 99; // Default max for minutes
        if(el.id.includes('sec')) max = 59; // Seconds max 59
        if(el.id.includes('rounds')) max = 999; // Rounds max 999

        let val = parseInt(el.value);
        if(isNaN(val) || val < 0) val = 0;
        if(val > max) val = max;
        
        el.value = val;
    }

    // --- App Core ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx = new AudioContext();
    let soundMode = 'beep'; 

    // Force Dark Mode Default if not set
    if (!localStorage.getItem('smartTimerTheme')) {
        localStorage.setItem('smartTimerTheme', 'dark');
    }

    function toggleTheme() {
        document.body.classList.toggle('light-theme');
        applyThemeText();
        localStorage.setItem('smartTimerTheme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
    }
    function applyThemeText() {
        const isLight = document.body.classList.contains('light-theme');
        document.getElementById('theme-text').innerText = isLight ? t('theme_light') : t('theme_dark');
    }
    // Init theme
    if (localStorage.getItem('smartTimerTheme') === 'light') {
        document.body.classList.add('light-theme');
    }

    const defaultPresets = {
        tabata: { name: "Tabata", work: 20, rest: 10, rounds: 8, prep: 5, warmupOn: false, warmupTime: 60, type: 'interval' },
        hiit:   { name: "HIIT",   work: 30, rest: 30, rounds: 10, prep: 5, warmupOn: true, warmupTime: 120, type: 'interval' },
        emom:   { name: "EMOM",   work: 60, rest: 0, rounds: 10, prep: 5, warmupOn: false, warmupTime: 60, type: 'loop' },
        gym:    { name: "Gym",    work: 40, rest: 90, rounds: 5, prep: 5, warmupOn: false, warmupTime: 0, type: 'interval' }
    };
    
    let presets = JSON.parse(localStorage.getItem('myTimerSettingsV21')) || JSON.parse(JSON.stringify(defaultPresets));
    let currentMode = 'tabata';
    let state = { phase: 'idle', timeLeft: 0, currentRound: 1, isRunning: false, timerId: null };
    let totalRemainingSeconds = 0;

    // --- Lang Functions ---
    function openLangModal() {
        playClick(); document.getElementById('lang-modal').classList.remove('hidden');
        document.querySelectorAll('.lang-item').forEach(el => el.classList.remove('selected'));
    }
    function closeLangModal() { playClick(); document.getElementById('lang-modal').classList.add('hidden'); }
    function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem('smartTimerLang', lang);
        applyLanguage();
        closeLangModal();
    }
    function applyLanguage() {
        document.getElementById('lang-display').innerText = translations[currentLang].lang_name;
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if(t(key)) el.innerText = t(key);
        });
        applyThemeText();
        updateSoundUI();
        updateWarmupUI();
        if(state.phase === 'idle') {
            document.getElementById('statusText').innerText = t('phase_prep');
            document.getElementById('actionBtn').innerText = t('btn_start');
        }
        if(state.isRunning) document.getElementById('actionBtn').innerText = t('btn_pause');
        
        // Update Title
        let titleKey = 'mode_' + currentMode + '_title';
        document.getElementById('modeBadge').innerText = t(titleKey);
    }

    // --- Info Modal ---
    function openInfoModal() {
        playClick();
        const infoTitle = document.getElementById('info-title');
        const infoContent = document.getElementById('info-content');
        if(currentMode === 'tabata') { infoTitle.innerText = t('mode_tabata_title'); infoContent.innerHTML = t('info_tabata'); }
        else if(currentMode === 'hiit') { infoTitle.innerText = t('mode_hiit_title'); infoContent.innerHTML = t('info_hiit'); }
        else if(currentMode === 'emom') { infoTitle.innerText = t('mode_emom_title'); infoContent.innerHTML = t('info_emom'); }
        else if(currentMode === 'gym') { infoTitle.innerText = t('mode_gym_title'); infoContent.innerHTML = t('info_gym'); }
        document.getElementById('info-modal').classList.remove('hidden');
    }
    function closeInfoModal() { playClick(); document.getElementById('info-modal').classList.add('hidden'); }

    // --- Time Utils ---
    function calculateTotalDuration(p) {
        let total = 0;
        total += p.prep;
        if(p.warmupOn) total += p.warmupTime;
        if(p.type === 'countdown') total += p.rest;
        else total += (p.work + p.rest) * p.rounds;
        return total;
    }
    function formatTime(seconds) {
        if(seconds < 0) seconds = 0;
        const m = Math.floor(seconds / 60).toString().padStart(2, '0');
        const s = (seconds % 60).toString().padStart(2, '0');
        return `${m}:${s}`;
    }
    function updateRemainingUI() {
        document.getElementById('mainRemainingTime').innerText = `${t('label_remaining')} ${formatTime(totalRemainingSeconds)}`;
    }
    function updateTotalTimeUI() {
        const p = presets[currentMode];
        const total = calculateTotalDuration(p);
        totalRemainingSeconds = total; 
        document.getElementById('mainRemainingTime').innerText = `${t('label_remaining')} ${formatTime(total)}`;
        document.getElementById('modalTotalTime').innerText = `${t('label_total_est')}: ${formatTime(total)}`;
    }
    function getTimeFromInputs(idPrefix) {
        const min = Math.max(0, parseInt(document.getElementById(idPrefix + '-min').value) || 0);
        const sec = Math.max(0, parseInt(document.getElementById(idPrefix + '-sec').value) || 0);
        return (min * 60) + sec;
    }
    function liveUpdateTotal() {
        const tempP = {
            prep: getTimeFromInputs('set-prep'),
            warmupOn: presets[currentMode].warmupOn,
            warmupTime: getTimeFromInputs('set-warmup'),
            work: getTimeFromInputs('set-work'),
            rest: getTimeFromInputs('set-rest'),
            rounds: Math.max(1, parseInt(document.getElementById('set-rounds').value) || 1),
            type: presets[currentMode].type
        };
        const total = calculateTotalDuration(tempP);
        document.getElementById('modalTotalTime').innerText = `${t('label_total_est')}: ${formatTime(total)}`;
    }

    // --- Logic ---
    function selectMode(mode) {
        playClick();
        currentMode = mode;
        const p = presets[mode];
        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('timer-screen').classList.remove('hidden');
        document.getElementById('modeBadge').innerText = t('mode_' + mode + '_title');
        updateSoundUI(); updateWarmupUI(); resetTimer(false);
    }

    function goBack() {
        playClick();
        clearInterval(state.timerId);
        state.isRunning = false;
        document.getElementById('timer-screen').classList.add('hidden');
        document.getElementById('home-screen').classList.remove('hidden');
        document.getElementById('app-container').style.background = 'var(--bg-idle)';
        document.body.classList.remove('active-mode');
    }

    function setControlsLocked(locked) {
        const navBar = document.getElementById('navBar');
        if (locked) navBar.classList.add('locked'); else navBar.classList.remove('locked');
        document.querySelectorAll('.lockable').forEach(btn => {
            if (locked) btn.classList.add('disabled'); else btn.classList.remove('disabled');
        });
    }

    function resetTimer(playAudio = true) {
        if(playAudio) playClick();
        clearInterval(state.timerId);
        state.isRunning = false;
        state.currentRound = 1;
        state.phase = 'idle';
        setControlsLocked(false);
        document.body.classList.remove('active-mode');
        document.getElementById('timerDigits').classList.remove('pulse');

        const p = presets[currentMode];
        if (p.prep > 0) state.timeLeft = p.prep;
        else if (p.warmupOn) state.timeLeft = p.warmupTime;
        else state.timeLeft = p.work;

        document.getElementById('actionBtn').innerText = t('btn_start'); 
        updateTotalTimeUI(); updateDisplay();
    }

    function toggleTimerState() {
        playClick();
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const btn = document.getElementById('actionBtn');
        const p = presets[currentMode];

        if (state.isRunning) {
            clearInterval(state.timerId);
            state.isRunning = false;
            btn.innerText = t('btn_start'); 
            document.getElementById('timerDigits').classList.remove('pulse');
        } else {
            setControlsLocked(true);
            document.body.classList.add('active-mode');
            
            if(state.phase === 'finished') resetTimer(false);
            state.isRunning = true;
            btn.innerText = t('btn_pause');
            
            if(state.phase === 'idle') {
                if (p.prep > 0) { state.phase = 'prep'; state.timeLeft = p.prep; announce(t('phase_prep'), "start"); }
                else if (p.warmupOn) { state.phase = 'warmup'; state.timeLeft = p.warmupTime; announce(t('phase_start_warmup'), "start"); }
                else { 
                    state.phase = 'work'; state.timeLeft = p.work; announce(t('phase_start_work'), "start");
                }
            }
            state.timerId = setInterval(tick, 1000);
            updateDisplay();
        }
    }

    function tick() {
        if (totalRemainingSeconds > 0) {
            totalRemainingSeconds--;
            updateRemainingUI();
        }
        if (state.timeLeft > 0) {
            state.timeLeft--;
        }
        if (state.timeLeft === 0) {
            nextPhase();
        } else {
             if (state.timeLeft <= 3) {
                 document.getElementById('timerDigits').classList.add('pulse');
                 if(soundMode==='beep') announce("", "tick");
                 if(soundMode==='voice') speak(state.timeLeft);
             } else {
                 document.getElementById('timerDigits').classList.remove('pulse');
             }
        }
        updateDisplay();
    }

    function nextPhase() {
        document.getElementById('timerDigits').classList.remove('pulse');
        const p = presets[currentMode];
        
        if (state.phase === 'prep') {
            if (p.warmupOn) { state.phase = 'warmup'; state.timeLeft = p.warmupTime; announce(t('phase_start_warmup'), "start"); }
            else { state.phase = 'work'; state.timeLeft = p.work; announce(t('phase_start_work'), "start"); }
        }
        else if (state.phase === 'warmup') {
            state.phase = 'work'; state.timeLeft = p.work; announce(t('phase_start_work'), "start");
        }
        else if (state.phase === 'work') {
            if (p.type === 'loop') finishRound(p);
            else { state.phase = 'rest'; state.timeLeft = p.rest; announce(t('phase_start_rest'), "rest"); }
        }
        else if (state.phase === 'rest') {
            finishRound(p);
        }
    }

    function finishRound(p) {
        if (state.currentRound < p.rounds) {
            state.currentRound++; state.phase = 'work'; state.timeLeft = p.work;
            announce(t(currentMode === 'gym' ? 'phase_gym_start' : 'phase_start_work'), "start");
        } else { finishAll(); }
    }

    function finishAll() {
        state.phase = 'finished'; announce(t('phase_finish_train'), "finish");
        clearInterval(state.timerId); state.isRunning = false;
        document.getElementById('actionBtn').innerText = t('btn_done');
        document.getElementById('mainRemainingTime').innerText = t('label_remaining') + " 00:00"; 
        setControlsLocked(false);
        document.getElementById('timerDigits').classList.remove('pulse');
    }

    function updateDisplay() {
        const m = Math.floor(state.timeLeft / 60).toString().padStart(2, '0');
        const s = (state.timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('timerDigits').innerText = `${m}:${s}`;
        
        const p = presets[currentMode];
        document.getElementById('roundsText').innerText = `${t('label_rounds')} ${state.currentRound} / ${p.rounds}`;
        
        const statusEl = document.getElementById('statusText');
        const container = document.getElementById('app-container');
        let text = '';

        if (state.phase === 'idle') { container.style.background = 'var(--bg-idle)'; text = t('phase_prep'); }
        else if (state.phase === 'prep') { container.style.background = 'var(--bg-prep)'; text = t('phase_prep'); }
        else if (state.phase === 'warmup') { container.style.background = 'var(--bg-warmup)'; text = t('phase_warmup'); }
        else if (state.phase === 'work') { 
            if(currentMode === 'gym') { container.style.background = 'var(--bg-gym-work)'; text = t('phase_gym_work'); }
            else { container.style.background = 'var(--bg-work)'; text = t('phase_work'); }
        } else if (state.phase === 'rest') { 
            container.style.background = 'var(--bg-rest)'; 
            text = (currentMode === 'gym') ? t('phase_gym_rest') : t('phase_rest');
        } 
        else if (state.phase === 'finished') { 
            container.style.background = 'var(--bg-finish)'; text = t('phase_finish'); 
            statusEl.style.color = '#333'; document.getElementById('timerDigits').style.color = '#333'; return; 
        }
        
        if(state.phase !== 'finished') {
             statusEl.style.color = '#fff'; document.getElementById('timerDigits').style.color = '#fff';
        }
        statusEl.innerText = text;
    }

    function toggleSoundMode() {
        playClick();
        if (soundMode === 'beep') soundMode = 'voice';
        else if (soundMode === 'voice') soundMode = 'mute';
        else soundMode = 'beep';
        updateSoundUI();
        if(soundMode === 'voice') speak(t('sound_voice')); else if(soundMode === 'beep') playTone(800, 0.1);
    }
    function updateSoundUI() {
        const icon = document.getElementById('btn-sound-icon');
        const text = document.getElementById('btn-sound-text');
        if (soundMode === 'voice') { icon.innerText = 'ğŸ—£ï¸'; text.innerText = t('sound_voice'); }
        else if (soundMode === 'beep') { icon.innerText = 'ğŸ””'; text.innerText = t('sound_beep'); }
        else { icon.innerText = 'ğŸ”•'; text.innerText = t('sound_mute'); }
    }

    function toggleWarmupDirect() {
        if(document.getElementById('btn-warmup').classList.contains('disabled')) return;
        playClick(); const p = presets[currentMode]; p.warmupOn = !p.warmupOn;
        savePresets(); updateWarmupUI(); updateTotalTimeUI(); resetTimer(false);
    }
    function updateWarmupUI() {
        const p = presets[currentMode];
        const btn = document.getElementById('btn-warmup');
        const sub = document.getElementById('btn-warmup-sub');
        if(p.warmupOn) { btn.classList.add('active'); sub.innerText = formatTime(p.warmupTime); } 
        else { btn.classList.remove('active'); sub.innerText = t('label_off'); }
    }
    
    function openSettings() { 
        if(document.querySelectorAll('.lockable')[0].classList.contains('disabled')) return;
        playClick(); document.getElementById('settings-modal').classList.remove('hidden'); loadSettingsToUI(); liveUpdateTotal(); 
    }
    function closeSettings() { playClick(); saveSettingsFromUI(); document.getElementById('settings-modal').classList.add('hidden'); updateWarmupUI(); resetTimer(false); }
    
    function loadSettingsToUI() {
        const p = presets[currentMode];
        const setInputs = (id, totalSec) => {
            document.getElementById(id + '-min').value = Math.floor(totalSec / 60);
            document.getElementById(id + '-sec').value = totalSec % 60;
        };
        setInputs('set-prep', p.prep);
        setInputs('set-warmup', p.warmupTime);
        setInputs('set-work', p.work);
        setInputs('set-rest', p.rest);
        document.getElementById('set-rounds').value = p.rounds;
        
        if(p.type === 'countdown') document.getElementById('row-work').classList.add('hidden');
        else document.getElementById('row-work').classList.remove('hidden');
    }

    function saveSettingsFromUI() {
        const p = presets[currentMode];
        p.prep = getTimeFromInputs('set-prep');
        p.warmupTime = getTimeFromInputs('set-warmup');
        p.work = getTimeFromInputs('set-work');
        p.rest = getTimeFromInputs('set-rest');
        p.rounds = Math.max(1, parseInt(document.getElementById('set-rounds').value) || 1);
        savePresets();
    }
    
    function savePresets() { localStorage.setItem('myTimerSettingsV21', JSON.stringify(presets)); }
    function restoreDefaults() {
        if(confirm("Restore defaults?")) { playClick(); presets[currentMode] = JSON.parse(JSON.stringify(defaultPresets[currentMode])); savePresets(); loadSettingsToUI(); updateWarmupUI(); resetTimer(false); }
    }
    function playClick() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.frequency.value = 1200; osc.type = 'triangle';
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);
        osc.stop(audioCtx.currentTime + 0.05);
    }
    function announce(text, type) {
        if (soundMode === 'mute') return;
        if (soundMode === 'voice') speak(text);
        else {
            if (type === 'start') playTone(880, 0.4);
            else if (type === 'rest') playTone(440, 0.4);
            else if (type === 'tick') playTone(600, 0.05);
            else if (type === 'finish') { playTone(880, 0.1); setTimeout(()=>playTone(880,0.1), 150); }
        }
    }
    function speak(text) {
        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text); u.rate = 1.1; 
            u.lang = currentLang; 
            window.speechSynthesis.speak(u);
        }
    }
    function playTone(freq, duration) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.frequency.value = freq; osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
        osc.stop(audioCtx.currentTime + duration);
    }
    
    applyLanguage(); // Init
</script>
</body>
</html>